<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>History Widget</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(to right, #ff9966, #ff5e62);
            font-family: 'Arial', sans-serif;
        }
        .widget-container {
            background: rgba(255, 255, 255, 0.85);
            border-radius: 15px;
            padding: 20px;
            margin: 20px auto;
            max-width: 800px;
        }
        .nav-tabs .nav-link {
            color: #495057;
        }
        .nav-tabs .nav-link.active {
            background-color: #ff9966;
            border-color: #ff9966;
            color: white;
        }
        .card {
            transition: transform .2s;
        }
        .card:hover {
            transform: scale(1.05);
        }
        .modal-content {
            background: #fff3cd;
        }
        .quiz-button {
            background-color: #5cb85c;
            border: none;
        }
        .quiz-button:hover {
            background-color: #4cae4c;
        }
    </style>
</head>
<body>

<div class="widget-container">
    <ul class="nav nav-tabs" id="historyTab" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="events-tab" data-bs-toggle="tab" data-bs-target="#events" type="button" role="tab" aria-controls="events" aria-selected="true">On This Day</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="figures-tab" data-bs-toggle="tab" data-bs-target="#figures" type="button" role="tab" aria-controls="figures" aria-selected="false">Famous Figures</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="quiz-tab" data-bs-toggle="tab" data-bs-target="#quiz" type="button" role="tab" aria-controls="quiz" aria-selected="false">Historical Quiz</button>
        </li>
    </ul>

    <div class="tab-content" id="historyTabContent">
        <!-- On This Day Tab -->
        <div class="tab-pane fade show active" id="events" role="tabpanel" aria-labelledby="events-tab">
            <h3 class="text-center mt-3">On This Day</h3>
            <p id="eventText">Click below to discover an event!</p>
            <button onclick="fetchRandomEvent()" class="btn btn-primary d-block mx-auto">Discover</button>
        </div>

        <!-- Famous Figures Tab -->
        <div class="tab-pane fade" id="figures" role="tabpanel" aria-labelledby="figures-tab">
            <div id="figureCards" class="row"></div>
            <nav aria-label="Page navigation">
                <ul class="pagination justify-content-center" id="figuresPagination"></ul>
            </nav>
        </div>

        <!-- Historical Quiz Tab -->
        <div class="tab-pane fade" id="quiz" role="tabpanel" aria-labelledby="quiz-tab">
            <h3 class="text-center">Historical Quiz</h3>
            <div id="quizQuestion"></div>
            <button id="quizStart" onclick="startQuiz()" class="quiz-button btn btn-lg d-block mx-auto">Start Quiz</button>
            <div id="quizOptions" class="mt-3"></div>
            <p id="quizScore" class="text-center mt-3"></p>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
<script>
// Mock data - ideally, use an API for real data
const events = [
    {text: "In 1492, Christopher Columbus sets sail from Spain."},
    {text: "The United States Declaration of Independence was signed in 1776."},
    // ... add more events
];

const figures = [
    {name: "Albert Einstein", summary: "Theoretical physicist known for the theory of relativity.", img: "einstein.jpg", detail: "Developed the general theory of relativity, one of the two pillars of modern physics."},
    {name: "Marie Curie", summary: "Pioneer in radioactivity research.", img: "curie.jpg", detail: "First woman to win a Nobel Prize, first person to win twice, and the only person to win in multiple sciences."},
    // ... add more figures up to 50 for 5 pages
];

let currentPage = 1;
const figuresPerPage = 10;

function fetchRandomEvent() {
    const randomEvent = events[Math.floor(Math.random() * events.length)];
    document.getElementById('eventText').textContent = randomEvent.text;
}

function displayFigures(page) {
    const start = (page - 1) * figuresPerPage;
    const end = start + figuresPerPage;
    const paginatedItems = figures.slice(start, end);
    let cards = '';
    paginatedItems.forEach(figure => {
        cards += `
        <div class="col-md-6 mb-3">
            <div class="card" data-bs-toggle="modal" data-bs-target="#figureModal" onclick="showFigureDetail('${figure.name}')">
                <img src="${figure.img}" class="card-img-top" alt="${figure.name}">
                <div class="card-body">
                    <h5 class="card-title">${figure.name}</h5>
                    <p class="card-text">${figure.summary}</p>
                </div>
            </div>
        </div>`;
    });
    document.getElementById('figureCards').innerHTML = cards;
    updatePagination();
}

function showFigureDetail(name) {
    const figure = figures.find(f => f.name === name);
    if (figure) {
        document.getElementById('modalTitle').innerText = figure.name;
        document.getElementById('modalBody').innerText = figure.detail;
    }
}

function updatePagination() {
    let pagination = '';
    for (let i = 1; i <= Math.ceil(figures.length / figuresPerPage); i++) {
        pagination += `<li class="page-item ${i === currentPage ? 'active' : ''}"><a class="page-link" href="#" onclick="changePage(${i})">${i}</a></li>`;
    }
    document.getElementById('figuresPagination').innerHTML = pagination;
}

function changePage(page) {
    currentPage = page;
    displayFigures(page);
}

// Quiz functionality
let quiz = [
    {q: "Who was the first person to fly solo across the Atlantic Ocean?", o: ["Amelia Earhart", "Charles Lindbergh", "Howard Hughes"], a: 1},
    // Add more questions here
];

let currentQuestion = 0;
let score = 0;

function startQuiz() {
    document.getElementById('quizStart').style.display = 'none';
    showQuestion();
}

function showQuestion() {
    if (currentQuestion < quiz.length) {
        let q = quiz[currentQuestion];
        document.getElementById('quizQuestion').innerText = q.q;
        let optionsHtml = '';
        q.o.forEach((option, index) => {
            optionsHtml += `<button class="btn btn-outline-primary btn-block" onclick="checkAnswer(${index})">${option}</button><br/>`;
        });
        document.getElementById('quizOptions').innerHTML = optionsHtml;
    } else {
        endQuiz();
    }
}

function checkAnswer(selected) {
    if (selected === quiz[currentQuestion].a) {
        score += 2;
    } else {
        endQuiz();
        return;
    }
    currentQuestion++;
    showQuestion();
}

function endQuiz() {
    document.getElementById('quizQuestion').innerText = `Quiz Over! Your score: ${score}`;
    document.getElementById('quizOptions').innerHTML = '';
    document.getElementById('quizScore').innerText = 'Click below to restart';
    document.getElementById('quizStart').innerText = 'Restart Quiz';
    document.getElementById('quizStart').style.display = 'block';
    // Reset quiz
    currentQuestion = 0;
    score = 0;
}

// Initial load
displayFigures(currentPage);
</script>

<!-- Modal for figure detail -->
<div class="modal fade" id="figureModal" tabindex="-1" aria-labelledby="figureModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modalTitle"></h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body" id="modalBody">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

</body>
</html>