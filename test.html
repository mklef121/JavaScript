<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f4;
        }
        .container {
            max-width: 1200px;
            margin: auto;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .rider-list, .report-section, .active-rides {
            margin-bottom: 20px;
        }
        .rider {
            display: flex;
            align-items: center;
            padding: 10px;
            border: 1px solid #ddd;
            margin: 5px 0;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .rider:hover {
            background-color: #f0f0f0;
        }
        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #6c63ff;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 10px;
        }
        .rides {
            display: none;
            flex-wrap: wrap;
        }
        .ride-card {
            background: #ffffff;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin: 10px;
            width: calc(33% - 20px);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.2s;
        }
        .ride-card:hover {
            transform: scale(1.05);
        }
        .map {
            height: 300px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: #eaeaea;
            margin-bottom: 20px;
        }
        .report {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        .chart {
            width: 100%;
            height: 200px;
            background-color: #eaeaea;
        }
    </style>
    <title>Enhanced Rider Management</title>
</head>
<body>

<div class="container">
    <h1>Delivery Rider Management</h1>
    <div class="rider-list">
        <h2>Riders</h2>
        <div id="riders"></div>
    </div>
    <div class="completed-rides">
        <h2>Completed Rides</h2>
        <div id="completed-rides" class="rides"></div>
        <div id="completed-ride-map" class="map"></div>
    </div>
    <div class="active-rides">
        <h2>Active Rides</h2>
        <div id="active-rides" class="active-rides"></div>
        <div id="active-ride-map" class="map"></div>
    </div>
    <div class="report-section">
        <h2>Reports</h2>
        <div id="report-summary" class="report"></div>
        <canvas id="report-chart" class="chart"></canvas>
    </div>
</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
    const riders = [
        { id: 1, name: "John Doe", avatar: "JD" },
        { id: 2, name: "Jane Smith", avatar: "JS" },
    ];

    const completedRidesMockData = [
        { riderId: 1, pickup: [40.73061, -73.935242], pickupName: "Location A", destination: [40.741061, -73.989699], destinationName: "Location B", time: "25 mins", customer: "Alice" },
        { riderId: 2, pickup: [40.749825, -73.987963], pickupName: "Location C", destination: [40.748817, -73.985428], destinationName: "Location D", time: "30 mins", customer: "Bob" },
        { riderId: 1, pickup: [40.73061, -73.935242], pickupName: "Location A", destination: [40.7577, -73.9857], destinationName: "Location E", time: "15 mins", customer: "Dave" },
        { riderId: 2, pickup: [40.748817, -73.985428], pickupName: "Location D", destination: [40.741061, -73.989699], destinationName: "Location B", time: "10 mins", customer: "Eve" }
    ];

    const activeRidesMockData = [
        { riderId: 1, pickup: [40.73061, -73.935242], pickupName: "Location A", destination: [40.751576, -73.993200], destinationName: "Location F", customer: "Charlie" }
    ];

    // Populate riders
    const riderList = document.getElementById('riders');
    riders.forEach(rider => {
        const riderDiv = document.createElement('div');
        riderDiv.className = 'rider';
        riderDiv.innerHTML = `<div class="avatar">${rider.avatar}</div>${rider.name}`;
        riderDiv.onclick = () => showCompletedRides(rider.id);
        riderList.appendChild(riderDiv);
    });

    // Show completed rides
    function showCompletedRides(riderId) {
        const ridesDiv = document.getElementById('completed-rides');
        const mapDiv = document.getElementById('completed-ride-map');
        ridesDiv.innerHTML = '';
        mapDiv.innerHTML = '';
        const completedRides = completedRidesMockData.filter(ride => ride.riderId === riderId);
        completedRides.forEach(ride => {
            const rideCard = document.createElement('div');
            rideCard.className = 'ride-card';
            rideCard.innerHTML = `
                <strong>Pickup:</strong> ${ride.pickupName}<br>
                <strong>Destination:</strong> ${ride.destinationName}<br>
                <strong>Time:</strong> ${ride.time}<br>
                <strong>Customer:</strong> ${ride.customer}
            `;
            rideCard.onclick = () => showRideDetails(ride);
            ridesDiv.appendChild(rideCard);
        });
        ridesDiv.style.display = 'flex';

        // Initialize map for completed ride
        if (completedRides.length > 0) {
            initMap(mapDiv, completedRides);
        }
    }

    // Show ride details
    function showRideDetails(ride) {
        alert(`Pickup: ${ride.pickupName}\nDestination: ${ride.destinationName}\nTime Taken: ${ride.time}\nCustomer: ${ride.customer}`);
    }

    // Initialize map
    function initMap(mapDiv, rides) {
        const map = L.map(mapDiv).setView(rides[0].pickup, 13);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
        }).addTo(map);
        L.marker(rides[0].pickup).addTo(map).bindPopup('Pickup Location: ' + rides[0].pickupName).openPopup();
        L.marker(rides[0].destination).addTo(map).bindPopup('Destination: ' + rides[0].destinationName).openPopup();
        L.polyline([rides[0].pickup, rides[0].destination], { color: 'blue' }).addTo(map);
    }

    // Populate active rides
    const activeRidesDiv = document.getElementById('active-rides');
    activeRidesMockData.forEach(ride => {
        const activeRideDiv = document.createElement('div');
        activeRideDiv.className = 'active-ride-detail';
        activeRideDiv.innerHTML = `Active: ${ride.pickupName} to ${ride.destinationName} - ${ride.customer}`;
        activeRideDiv.onclick = () => showActiveRideDetails(ride);
        activeRidesDiv.appendChild(activeRideDiv);
    });

    // Show active ride details
    function showActiveRideDetails(ride) {
        alert(`Pickup: ${ride.pickupName}\nDestination: ${ride.destinationName}\nCustomer: ${ride.customer}`);
        initActiveRideMap(ride);
    }

    // Initialize map for active ride
    function initActiveRideMap(ride) {
        const mapDiv = document.getElementById('active-ride-map');
        mapDiv.innerHTML = '';
        const map = L.map(mapDiv).setView(ride.pickup, 13);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
        }).addTo(map);
        const pickupMarker = L.marker(ride.pickup).addTo(map).bindPopup('Pickup Location: ' + ride.pickupName).openPopup();
        const destinationMarker = L.marker(ride.destination).addTo(map).bindPopup('Destination: ' + ride.destinationName).openPopup();
        L.polyline([ride.pickup, ride.destination], { color: 'red' }).addTo(map);

        // Simulate the rider moving
        let currentLatLng = [...ride.pickup];
        const interval = setInterval(() => {
            if (currentLatLng[0] < ride.destination[0]) {
                currentLatLng[0] += 0.001; // Simulating movement in latitude
                pickupMarker.setLatLng(currentLatLng);
            } else {
                clearInterval(interval);
            }
        }, 1000);
    }

    // Generate reports
    function generateReport() {
        const reportDiv = document.getElementById('report-summary');
        reportDiv.innerHTML = `
            <div>Total Deliveries: ${completedRidesMockData.length}</div>
            <div>Total Active Rides: ${activeRidesMockData.length}</div>
        `;
        drawReportChart();
    }
    
    // Chart.js for report visualization
    function drawReportChart() {
        const ctx = document.getElementById('report-chart').getContext('2d');
        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Completed Rides', 'Active Rides'],
                datasets: [{
                    label: 'Number of Rides',
                    data: [completedRidesMockData.length, activeRidesMockData.length],
                    backgroundColor: [
                        'rgba(54, 162, 235, 0.6)',
                        'rgba(255, 206, 86, 0.6)',
                    ],
                    borderColor: [
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
    }

    generateReport();
</script>
</body>
</html>


-- working Map